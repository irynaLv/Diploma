["function _661eaaa597bf3e382cb326a6ed0daf16c8a5fb4f(){};var DL=DL||{};if(!DL.controller){DL.controller={}}if(!DL.model){DL.model={}}if(!DL.store){DL.store={}}",69,573763,"model.Documents\",Ext.data.Model,{config:{fields:[{name:\"_id\",type:\"string\"},{name:\"accessLayer\",type:\"int\"},{name:\"description\",type:\"string\"},{name:\"fileName\",type:\"string\"},{name:\"owner\",type:\"string\"},{name:\"title\",type:\"string\"},{name:\"type\",type:\"string\"},{name:\"uploadDate\",type:\"date\"}]}},0,0,0,0,0,0,[DL.model,\"Documents",591103,32,"XTitlebar\",Ext.TitleBar,{me:this,",574644,593,"idden:true",575235,72,"3",575308,148,"3",575457,93,",{xtype:\"button\",cls:\"logout-btn\",itemId:\"logout-btn\",scope:this,width:\"3",575308,33,"gnome-logout-icone-3872-128.png\",hidden:true",575549,298,"login-btn\").setHidden(!this.getHiddenEl()",575833,37,"idden(this.getHiddenEl());this.down(\"#logout-btn\").setHidden(this.getHiddenEl());this.down(\"#user-document-btn\").setHidden(this.getHiddenEl()",575833,66,575965,264,"getHiddenEl:function(){var a=localStorage.getItem(\"userData\");if(a",444662,33,576410,231,587260,90,"width:\"100%\",height:\"90%\",flex:1,left:0,top:\"10%\",right:0,cls:\"news-container\",items:[{xtype:\"dataview\",store:\"documents\",itemId:\"news-list\",height:\"100%\",flex:1,cls:\"news-list\",itemTpl:new Ext.XTemplate('<div class=\"news-item\"><div class=\"main-cont\"><div class=\"news\">{owner} \\u043",589499,53,"32 \\u0444\\u0430\\u0439\\u043b {fileName}</div>','<div class=\"download\"></div>',\"</div>\",'<div class=\"description\"> {description}</div>',\"</div>\",{getDate:function(a){}})}],listeners:[{delegate:\"div.download\",element:\"element\",event:\"tap\",fn:function(c,g,b,f,a){var d=Ext.get(c.delegatedTarget.parentElement);this.fireEvent(\"downloadDocument\")}},{delegate:\"div.news\",element:\"element\",event:\"tap\",fn:function(d,h,c,g,b){var f=Ext.get(d.delegatedTarget.parentElement);var a=f.dom.nextElementSibling.getAttribute(\"style\",\"display\");if(a==\"display:block\"){f.dom.nextElementSibling.setAttribute(\"style\",\"display:none\")}else{f.dom.nextElementSibling.setAttribute(\"style\",\"display:block\")}}",586714,34,"callParent()",576641,243,"},itemId:\"main\",width:\"100%\",height:\"100%\",flex:1",576925,250,578009,485,578703,39,591456,45,578601,48,578742,3276,"e,g,i,h,b,d,f){var c={name:a,surname:e,email:g,password:i,birthday:h,status:b,role:d,sex:f};this.fireEvent(\"submitRegistrationForm\",c",582322,185,"d",582508,38,"f",582547,36,"h",592279,35,"var i",582666,44,"g",582711,75,"e",582787,84,"f!=\"\"&&this.validateEmail(f)){",583596,65,583389,93,583062,47,"if(h!=\"\"&&h!=i",583328,210,"d",583539,36,"d,f,h,g,c,e",583586,609,"controller.RegistrationForm\",Ext.app.Controller,{config:{refs:{registrationForm:{xtype:\"registration-form\",selector:\"registration-form\",autoCreate:true}},control:{registrationForm:{submitRegistrationForm:\"sendRegistrationRequest\"}}},sendRegistrationRequest:function(b){var a",582038,43,"/signup\",params:{password:b.password,firstName:b.name,secondName:b.surname,email:b.email,role:b.role,status:b.status,sex:b.sex,birthDay:b.birthday",592406,64,"}},0,0,0,0,0,0,[DL.controller",584150,184,"24",584336,496,586789,71,580623,35,584868,128,585066,269,"owner",585341,323,"value:0,itemId:\"trainingMaterials",585662,161,"value:1,itemId:\"regulations",585821,167,"value:2,itemId:\"minutesOfMeetings\",label",588092,106,588846,37,"60%\",value:3,itemId:\"informationMaterials",586139,179,"value:4,itemId:\"advertisement",586316,251,",handler:\"advancedSearch",586566,124,"lose-search-pan",586693,180,"search",575712,34,"search-btn\").setHandler(this.advancedSearch);this.callParent()},advancedSearch:function(){var f=this.down(\"#date-create-from",582489,32,"date-create-to",582803,32,"owner\").getValue();var d=this.getType();var c={owner:b,type:d};var a={from:f,to:e};this.fireEvent(\"sendAdvancedSearch\",c,a)},getType:function(){var a=[];if(this.down(\"#trainingMaterials\").getChecked()){a.push(this.down(\"#trainingMaterials\").getValue())}if(this.down(\"#regulations\").getChecked()){a.push(this.down(\"#regulations\").getValue())}if(this.down(\"#minutesOfMeetings\").getChecked()){a.push(this.down(\"#minutesOfMeetings\").getValue())}if(this.down(\"#informationMaterials\").getChecked()){a.push(this.down(\"#informationMaterials\").getValue())}if(this.down(\"#advertisement\").getChecked()){a.push(this.down(\"#advertisement\").getValue())}return a",586984,239,"controller.Search\",Ext.app.Controller,{config:{refs:{searchPanel:{xtype:\"search-document-panel\",selector:\"search-document-panel\",autoCreate:true},closeSearchPanelBtn:\"component[itemId=close-search-panel-btn]\",titlebar:{xtype:\"xtitlebar\",selector:\"xtitlebar\",autoCreate:true},searchField:\"xtitlebar component[itemId= documentSearch]\"},control:{searchPanel:{sendAdvancedSearch:\"searchByTags\"},closeSearchPanelBtn:{tap:\"closeSearchPanel\"},searchField:{focus:\"openAdvancedSearch\",action:\"searchByName\"}}},searchByName",586731,130,"var a={from:this.dateTo,to:this.dateFrom};var b=this.getSearchField().getValue();var c=Ext.Ajax.request({method:\"GET\",url:\"/getDocuments\",params:{name:b,tags:null,timePeriod:a},success:function(d){var e=d",592435,35,"},searchByTags:function(c,a){var b=this.getSearchField(",592301,39,"GET\",url:\"/getDocuments\",params:{name:b,tags:c,timePeriod:a},success:function(d){var e=d",592435,35,586940,35,"searchPanel.setHidden(true)},openAdvancedSearch",576243,109,"getSearchField())}else{this.searchPanel.setHidden(false)}}},0,0,0,0,0,0,[DL.controller",539736,32,587220,731,"0",587952,132,"1",588085,120,"2",588206,144,"3",588351,77,"4",588429,41,"5}]",585360,34,588507,164,"itemId:\"access-layer-",588664,114,"value:0",588777,128,"value:1,label",579343,44,585774,44,588998,56,"value:2",589053,84,"value:3",589136,32,585370,38,"hidden:false,itemId:\"upload-file-container\",items:[{xtype:\"panel\",width:\"60%\",cls:\"file-name\",itemId:\"file-name\",html:\"\\u0424\\u0430\\u0439\\u043b \\u043d\\u0435 \\u0432\\u0438\\u0431\\u0440\\u0430\\u043d\\u0438\\u0439\"},{xtype:\"button\",t",589245,80,"cls:\"take-file-btn\",itemId:\"take-file-btn\",handler:\"onAttachFile\",scope:this,width:\"39%\"",589158,167,"hidden:true}]",580831,35,589407,573,"screenshot=null;",589975,242,"closedBtn=this.down(\"#close-btn\");this.workerAcces",590227,40,590266,72,"s=this.down(\"#allUsers\");this.takeFileBtn=this.down(\"#take-file-btn\");this.accessTitle=this.down(\"#access-layer-title\");this.fileName=this.down(\"#file-name\");this.fileContainer=this.down(\"#upload-file-container\");this.takeFileBtn.setScope(this);this.takeFileBtn.setHandler(this.onAttachFile",590360,147,"losedBtn.on(\"tap\",this.closeAddDocumentBtn,this);this.callParent()},onAttachFile:function(){var a=",590829,35,";var b=this;a.addEventListener(\"change\",function(d){var c=this,f=d;b.handleFileUpload(f,c)},false);a.click();console.log(\"Creating screenshot\")},handleFileUpload:function(f,d){var e=this;var b=d.files;if(b.length>0){var c=b[0];var a=new FileReader();a.onload=function(h){var g=h.target.result;e.screenshot=g;e.fileName.setHtml(e",590833,37,")};a.readAsDataURL(c)}",590518,38,"4){this.fileContainer.setHidden(true)}else{this.fileContainer.setHidden(fals",590591,118,590708,37,590744,66,"s.setChecked(false);this.fileName.setHtml(\"\\u0424\\u0430\\u0439\\u043b \\u043d\\u0435 \\u0432\\u0438\\u0431\\u0440\\u0430\\u043d\\u0438\\u0439\")},onUploadBtn:function(){var a=this.name.getValue();var k=this.description.getValue();var j=this.type.getValue();var h=this.workerAccess.getChecked();var f=this.studentAccess.getChecked();var c=this.owner.getChecked();var b=this.allUserAccess.getChecked();var e=this.screenshot;var i=false;var d=[];if(!a){this.name.addCls(\"error\");i=true}else{this.name.element.removeCls(\"error\");this.name.removeCls(\"error\")}if(!k){this.description.addCls(\"error\");i=true}else{this.description.element.removeCls(\"error\");this.description.removeCls(\"error\")}if(h||f||c||b){this.accessTitle.element.removeCls(\"error\");this.accessTitle.removeCls(\"error\");d=this.getAccessValue()}else{this.accessTitle.addCls(\"error\");i=true}if(!this.fileContainer.getHidden()){if(!e){this.fileName.addCls(\"error\");i=true}else{this.fileName.element.removeCls(\"error\");this.fileName.removeCls(\"error\")}}if(!i){var g={name:a,description:k,type:j,access:d,file:e};this.fireEvent(\"uploadNewFile\",g)}},getAccessValue:function(){var a=[];if(this.workerAccess.getChecked()){a.push(this.workerAccess.getValue())}if(this.studentAccess.getChecked()){a.push(this.studentAccess.getValue())}if(this.owner.getChecked()){a.push(this.owner.getValue())}if(this.allUserAccess.getChecked()){a.push(this.allUserAccess.getValue())}return a},closeAddDocumentBtn:function(){this.destroy()",590898,232,"controller.AddDocument\",Ext.app.Controller,{config:{refs:{addDocumentPanel:{xtype:\"add-document-panel\",selector:\"add-document-panel\",autoCreate:true},uploadNewDocumentBtn:\"add-document-panel component[itemId=upload-btn]\"},control:{addDocumentPanel:{uploadNewFile:\"uploadNewDocument\"}}},uploadNewDocument:function(f){var c=localStorage.getItem(\"userData\");if(c){var b=c.split('\"');var a=b.indexOf(\"lastLame\");var d=b[a+2];var e=b.indexOf(\"title\");var g=b[e+2]}",582044,37,"/api/document\",params:{fileName:f.name,owner:d,description:f.description,type:f.type,accessLayer:f.accessValue,binaryFile:f.file,title:g},success:function(h){var j=h.responseText;var i=JSON.parse(j)},error:function(){}})}},0,0,0,0,0,0,[DL.controller",591090,323,",value:\"jcooper@lajo.m",591410,90,",value:\"JXSVo8EeD\"}]",580831,104,591606,635,"d",582547,36,"c",592279,35,"var a=this.down(\"#email\");var e=this.down(\"#password\");var b=false;if(d!=\"\"){if(d!=\"\"&&!this.validateEmail(d)){a.addCls(\"error\");b=true}else{if(a.element.hasCls(\"error\")){a.element.removeCls(\"error\");a.removeCls(\"error\")}}}else{a.addCls(\"error\");b=true}if(c==\"\"){e.addCls(\"error\");b=true}else{if(e.element.hasCls(\"error\")){e.element.removeCls(\"error\");e.removeCls(\"error\")}}if(!b){this.fireEvent(\"sendLoginForm\",d,c)}",582323,81,592505,271,592788,41,277984,39,"\"login-form\"",592907,38,"],0,[DL.view,\"Logi",584163,32,"controller.Login\",Ext.app.Controller,{config:{refs:{loginPanel:{xtype:\"login-form\",selector:\"login-form\",autoCreate:true},submitSearchPanelBtn:\"login-form component[itemId=submit-btn]\",loginBtn:\"xtitlebar component[itemId=login-btn]\",logoutBtn:\"xtitlebar component[itemId=logout-btn]\",newDocumentBtn:\"xtitlebar component[itemId= add-document-btn]\",userDocumentBtn:\"xtitlebar component[itemId=user-document-btn]\"},control:{loginPanel:{sendLoginForm:\"sendLoginRequest\"},logoutBtn:{tap:\"logoutUser\"}}},sendLoginRequest:function(b,a){var c",582038,43,592372,53,"d){var e=d.responseText;c.loginUser(e)},error:function(){}})},loginUser:function(c){var a=c.split('\"');for(var b=0;b<a.length;b++){if(a[b]==\"No user found.\"){return}}this.userData=JSON.parse(c);localStorage.setItem(\"userData\",c);this.getLoginBtn().setHidden(true);this.getNewDocumentBtn().setHidden(false);this.getUserDocumentBtn().setHidden(false);this.getLogoutBtn().setHidden(false);this.getLoginPanel().destroy();this.loadDocuments()},logoutUser:function(){var a",582038,32,"GET\",url:\"/logout\",params:{},success:function(b){var c=b.responseText;a.getLoginBtn().setHidden(false);a.getNewDocumentBtn().setHidden(true);a.getUserDocumentBtn().setHidden(true);a.getLogoutBtn().setHidden(true);localStorage.removeItem(\"userData\")},error:function(){}})},loadDocuments:function(){var b=this.userData._id;var a={from:",586780,80,",to:new Date()};Ext.Ajax.request({method:\"GET\",url:\"/api/documents\",params:{title:null,userId:b,tags:null,timePeriod:a",592406,42,";this.documents=JSON.parse(d);this.updateMainPage()},error:function(){}})},updateMainPage:function(){}},0,0,0,0,0,0,[DL.controller,\"Login\"],0));(Ext.cmd.derive(\"DL.store.Documents\",Ext.data.Store,{config:{model:\"DL.model.Documents\",autoLoad:false,storeId:\"documents\",autoSync:true}},0,0,0,0,0,0,[DL.store,\"Documents\"],0));(Ext.cmd.derive(\"DL.controller.News\",Ext.app.Controller,{config:{refs:{newsContainer:{xtype:\"news-container\",selector:\"news-container\",autoCreate:true},newsList:\"news-container component[itemId=news-list]\"},control:{newsContainer:{initialize:\"onInitialize\"}}},onInitialize:function(){var b=this;var a={from:",586780,80,",to:new Date()};Ext.Ajax.request({method:\"GET\",url:\"/api/documents\",params:{title:null,userId:null,tags:null,timePeriod:a",592406,42,";b.documents=JSON.parse(d);b.updateMainPage()},error:function(){}})},updateMainPage:function(){var a=Ext.getStore(\"documents\");console.log(\"Store is \",a);a.setData(this.documents);this.getNewsList().refresh()}},0,0,0,0,0,0,[DL.controller,\"News\"],0));Ext.Loader.setConfig({disableCaching:false}",577173,70,",\"XTitlebar\",\"LoginForm\",\"RegistrationForm\",\"AddDocument\",\"Search\",\"News\"],controllers:[\"RegistrationForm\",\"Search\",\"AddDocument\",\"Login\",\"News\"],stores:[\"DL.store.Documents\"],models:[\"Documents",577242,767]